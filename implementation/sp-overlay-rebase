#!/usr/bin/env bash
set -euo pipefail

overlay="${1:?overlay required}"
new_parent="${2:-}"

repo="${SP_REPO_ROOT:-.}"

if [[ -z "$new_parent" ]]; then
  SP_REPO_ROOT="$repo" sp-overlay-parent "$overlay" "" >/dev/null
  echo "Rebased $overlay onto base (no parent)."
else
  SP_REPO_ROOT="$repo" sp-overlay-parent "$overlay" "$new_parent" >/dev/null
  echo "Rebased $overlay onto parent: $new_parent"
fi

